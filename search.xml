<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>青龙面板搭建</title>
    <url>/2024/08/09/%E9%9D%92%E9%BE%99%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA/</url>
    <content><![CDATA[<h1 id="青龙面板搭建"><a href="#青龙面板搭建" class="headerlink" title="青龙面板搭建"></a>青龙面板搭建</h1><h2 id="环境需求："><a href="#环境需求：" class="headerlink" title="环境需求："></a>环境需求：</h2><ol>
<li>一台云服务器</li>
<li>一台远程终端连接客户端</li>
</ol>
<blockquote>
<p><strong>这里演示的服务器为：Azure云服务器，Xshell 远程连接终端</strong></p>
</blockquote>
<span id="more"></span>

<h2 id="步骤："><a href="#步骤：" class="headerlink" title="步骤："></a>步骤：</h2><h3 id="Docker-安装"><a href="#Docker-安装" class="headerlink" title="Docker 安装"></a><strong>Docker 安装</strong></h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bash &lt;(curl -sSL https://linuxmirrors.cn/docker.sh)</span><br></pre></td></tr></table></figure>

<p><img src="/../images/Docker%E5%AE%89%E8%A3%851.png" alt="Docker安装1"></p>
<p><img src="/../images/Docker%E5%AE%89%E8%A3%852.png" alt="Docker安装2"></p>
<p><img src="/../images/Docker%E5%AE%89%E8%A3%853.png" alt="Docker安装3"></p>
<h3 id="青龙面板一键安装"><a href="#青龙面板一键安装" class="headerlink" title="青龙面板一键安装"></a><strong>青龙面板一键安装</strong></h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -dit \</span><br><span class="line">  -v $PWD/ql/data:/ql/data \</span><br><span class="line">  -p 5700:5700 \</span><br><span class="line">  -e QlBaseUrl=&quot;/&quot; \</span><br><span class="line">  -e QlPort=&quot;5700&quot; \</span><br><span class="line">  --name qinglong \</span><br><span class="line">  --hostname qinglong \</span><br><span class="line">  --restart unless-stopped \</span><br><span class="line">  whyour/qinglong:2.16.5		</span><br><span class="line">  </span><br><span class="line"><span class="meta prompt_">  #</span><span class="language-bash">这里2.16.5是版本，latest是最新版</span></span><br></pre></td></tr></table></figure>

<p><img src="/../images/%E9%9D%92%E9%BE%99%E9%9D%A2%E6%9D%BF%E5%AE%89%E8%A3%851.png" alt="青龙面板安装1"></p>
<p>​	由此可看到端口为5700</p>
<p><img src="/../images/%E9%9D%92%E9%BE%99%E9%9D%A2%E6%9D%BF%E5%AE%89%E8%A3%852.png" alt="青龙面板安装2"></p>
<h3 id="打开青龙面板"><a href="#打开青龙面板" class="headerlink" title="打开青龙面板"></a>打开青龙面板</h3><blockquote>
<p>由于Azure 云服务器为开放5700 这个端口,所有我们需要去Azure 云服务后台开启这个端口.</p>
</blockquote>
<p><img src="/../images/%E5%85%A5%E7%AB%99.png" alt="入站"></p>
<blockquote>
<p><strong>出站也是如此</strong></p>
</blockquote>
<p>配置完成后代开浏览器,输入你的服务器 <code>IP:5700</code></p>
<p><img src="/../images/%E9%9D%92%E9%BE%99%E9%9D%A2%E6%9D%BF1.png" alt="青龙面板1"></p>
<blockquote>
<p><strong>根据提示完成安装</strong> <strong>,通知设置可跳过</strong></p>
</blockquote>
<h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><h4 id="NodeJs依赖"><a href="#NodeJs依赖" class="headerlink" title="NodeJs依赖"></a><strong>NodeJs依赖</strong></h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">node-rsa</span><br><span class="line">jsrsasign</span><br><span class="line">request</span><br><span class="line">crypto-js</span><br><span class="line">prettytable</span><br><span class="line">dotenv</span><br><span class="line">jsdom</span><br><span class="line">date-fns</span><br><span class="line">tough-cookie</span><br><span class="line">tslib</span><br><span class="line">ws@7.4.3</span><br><span class="line">ts-md5</span><br><span class="line">jsdom -g</span><br><span class="line">jieba</span><br><span class="line">fs</span><br><span class="line">form-data</span><br><span class="line">json5</span><br><span class="line">global-agent</span><br><span class="line">png-js</span><br><span class="line">types/node</span><br><span class="line">require</span><br><span class="line">typescript</span><br><span class="line">js-base64</span><br><span class="line">axios</span><br><span class="line">moment</span><br></pre></td></tr></table></figure>

<h4 id="python依赖"><a href="#python依赖" class="headerlink" title="python依赖"></a><strong>python依赖</strong></h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pycryptodome</span><br><span class="line">sm-crypto</span><br><span class="line">crypto</span><br><span class="line">Crypto</span><br><span class="line">requests</span><br><span class="line">canvas</span><br><span class="line">ping3</span><br><span class="line">jieba</span><br><span class="line">PyExecJS</span><br><span class="line">aiohttp</span><br></pre></td></tr></table></figure>

<h4 id="Linux依赖"><a href="#Linux依赖" class="headerlink" title="Linux依赖"></a><strong>Linux依赖</strong></h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bizCode</span><br><span class="line">bizMsg</span><br><span class="line">lxm</span><br></pre></td></tr></table></figure>

<p><img src="/assets/%E4%BE%9D%E8%B5%96%E5%AE%89%E8%A3%85.png" alt="依赖安装"></p>
<blockquote>
<p><strong>同理, 依次安装依赖,遇到安装失败的暂时可无视,暂时不会受影响</strong></p>
</blockquote>
<h2 id="至此-青龙面板搭建完成"><a href="#至此-青龙面板搭建完成" class="headerlink" title="至此 青龙面板搭建完成"></a>至此 青龙面板搭建完成</h2>]]></content>
  </entry>
  <entry>
    <title>Mongodb 安装配置</title>
    <url>/2024/07/01/IEC/Mongodb_%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<h1 id="Mongodb-安装"><a href="#Mongodb-安装" class="headerlink" title="Mongodb 安装"></a>Mongodb 安装</h1><span id="more"></span>



<h2 id="解压tar包"><a href="#解压tar包" class="headerlink" title="解压tar包"></a>解压tar包</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zxvf mongodb-linux-x86_64-rhel70-7.0.11.tgz</span><br></pre></td></tr></table></figure>

<h2 id="创建用户组"><a href="#创建用户组" class="headerlink" title="创建用户组"></a>创建用户组</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">useradd mongod</span><br></pre></td></tr></table></figure>

<h2 id="给文件赋权限"><a href="#给文件赋权限" class="headerlink" title="给文件赋权限"></a>给文件赋权限</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chown -R mongod:mongod /home/bigdata/mongodb/</span><br></pre></td></tr></table></figure>

<h2 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">systemctl stop firewalld.service</span><br></pre></td></tr></table></figure>

<h2 id="启动Mongodb"><a href="#启动Mongodb" class="headerlink" title="启动Mongodb"></a>启动Mongodb</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./bin/mongod --config mongod.conf </span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>IEC</category>
      </categories>
  </entry>
  <entry>
    <title>Linux 安装环境配置</title>
    <url>/2024/07/14/IEC/IEC/</url>
    <content><![CDATA[<h1 id="Linux-安装环境配置"><a href="#Linux-安装环境配置" class="headerlink" title="Linux 安装环境配置"></a>Linux 安装环境配置</h1><span id="more"></span>

<h2 id="配置网络环境："><a href="#配置网络环境：" class="headerlink" title="配置网络环境："></a>配置网络环境：</h2><h3 id="编辑-etc-sysconfig-network-scripts-ifcfg-ens33-网络接口配置文件"><a href="#编辑-etc-sysconfig-network-scripts-ifcfg-ens33-网络接口配置文件" class="headerlink" title="编辑 /etc/sysconfig/network-scripts/ifcfg-ens33 网络接口配置文件"></a>编辑 <code>/etc/sysconfig/network-scripts/ifcfg-ens33</code> 网络接口配置文件</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim /etc/sysconfig/network-scripts/ifcfg-ens33 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将获取IP地址设置为静态</span></span><br><span class="line">BOOTPROTO= &quot;static&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">在配置文件里追加以下内容</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">22、21 是我的网段号与主机号，具体以本机为主。</span></span><br><span class="line">IPADDR=192.168.22.21</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=192.168.22.2</span><br><span class="line">DNS=114.114.114.114</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="保存退出，并重新加载一下配置文件："><a href="#保存退出，并重新加载一下配置文件：" class="headerlink" title="保存退出，并重新加载一下配置文件："></a>保存退出，并重新加载一下配置文件：</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure>



<h3 id="可运行以下命令查看是否修改成功"><a href="#可运行以下命令查看是否修改成功" class="headerlink" title="可运行以下命令查看是否修改成功"></a>可运行以下命令查看是否修改成功</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ip  a</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/image-20240714184402917.png" alt="image-20240714184402917"></p>
<blockquote>
<p>至此：网络接口配置结束！</p>
</blockquote>
<h2 id="修改主机名"><a href="#修改主机名" class="headerlink" title="修改主机名"></a>修改主机名</h2><h3 id="可运行以下命令修改"><a href="#可运行以下命令修改" class="headerlink" title="可运行以下命令修改"></a>可运行以下命令修改</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">test1 为你实际需要修改的名字，这里以test1 代替。</span></span><br><span class="line">hostnamectl set-hostname test1</span><br><span class="line">bash </span><br></pre></td></tr></table></figure>

<p><img src="/../../images/image-20240714184906035.png" alt="image-20240714184906035"></p>
<h3 id="配置网络映射（可选：便于后续操作）"><a href="#配置网络映射（可选：便于后续操作）" class="headerlink" title="配置网络映射（可选：便于后续操作）"></a>配置网络映射（可选：便于后续操作）</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim  /etc/hosts</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">保存退出即可</span></span><br></pre></td></tr></table></figure>

<p><img src="/../../images/image-20240714185201567.png" alt="image-20240714185201567"></p>
<h2 id="安装-JDK"><a href="#安装-JDK" class="headerlink" title="安装 JDK"></a>安装 <code>JDK</code></h2><h3 id="将软件包上传至-opt-module-目录-如果没有可以创建一个："><a href="#将软件包上传至-opt-module-目录-如果没有可以创建一个：" class="headerlink" title="将软件包上传至 /opt/module 目录,如果没有可以创建一个："></a>将软件包上传至 <code>/opt/module</code> 目录,如果没有可以创建一个：</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建moduel 目录</span></span><br><span class="line">mkdir  -p   /opt/module</span><br></pre></td></tr></table></figure>



<h3 id="上传成功后，运行以下命令安装软件"><a href="#上传成功后，运行以下命令安装软件" class="headerlink" title="上传成功后，运行以下命令安装软件"></a>上传成功后，运行以下命令安装软件</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zxvf jdk-8u241-linux-x64.tar.gz</span><br></pre></td></tr></table></figure>



<h3 id="在-etc-profile-d-目录下创建一个-sh-可执行文件"><a href="#在-etc-profile-d-目录下创建一个-sh-可执行文件" class="headerlink" title="在 /etc/profile.d 目录下创建一个 .sh 可执行文件"></a>在 <code>/etc/profile.d</code> 目录下创建一个 <code>.sh</code> 可执行文件</h3><blockquote>
<p><font color = red>编写以下内容：</font></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/etc/profile.d/my_var.sh</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">export</span> MY_VAR=<span class="string">&quot;your_value&quot;</span></span></span><br><span class="line"></span><br><span class="line">export JAVA_HOME=/opt/module/jdk1.8.0_241</span><br><span class="line">export PATH=$JAVA_HOME/bin:$PATH</span><br></pre></td></tr></table></figure>



<h4 id="给脚本文件添加可执行权限"><a href="#给脚本文件添加可执行权限" class="headerlink" title="给脚本文件添加可执行权限"></a>给脚本文件添加可执行权限</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo chmod +x /etc/profile.d/my_var.sh</span><br></pre></td></tr></table></figure>



<h4 id="加载新配置"><a href="#加载新配置" class="headerlink" title="加载新配置"></a>加载新配置</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<blockquote>
<p>运行 <code>Java -version</code> 即可看到配置已被修改成功</p>
</blockquote>
<p><img src="/../../images/image-20240714192249755.png" alt="image-20240714192249755"></p>
<h4 id="为什么不直接编辑-etc-profile"><a href="#为什么不直接编辑-etc-profile" class="headerlink" title="为什么不直接编辑 /etc/profile"></a>为什么不直接编辑 <code>/etc/profile</code></h4><ul>
<li><strong>升级和维护</strong>：直接编辑 <code>/etc/profile</code> 可能会在系统升级时被覆盖，从而丢失你的修改。</li>
<li><strong>可维护性</strong>：使用 <code>/etc/profile.d/</code> 目录可以将不同的环境变量配置分开存放，便于管理和维护。</li>
<li><strong>可读性</strong>：在 <code>/etc/profile</code> 中添加过多的环境变量配置可能会使文件变得冗长和难以阅读。</li>
</ul>
<h2 id="Hadoop-安装-伪分布式"><a href="#Hadoop-安装-伪分布式" class="headerlink" title="Hadoop 安装(伪分布式)"></a><code>Hadoop</code> 安装(伪分布式)</h2><h3 id="运行以下命令安装软件"><a href="#运行以下命令安装软件" class="headerlink" title="运行以下命令安装软件"></a>运行以下命令安装软件</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@test1 module]# tar -zxvf hadoop-3.1.4.tar.gz</span><br></pre></td></tr></table></figure>

<h4 id="在-etc-profile-d-my-var-sh-里追加以下内容"><a href="#在-etc-profile-d-my-var-sh-里追加以下内容" class="headerlink" title="在 /etc/profile.d/my_var.sh 里追加以下内容"></a>在 <code>/etc/profile.d/my_var.sh</code> 里追加以下内容</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">hadoop var</span></span><br><span class="line">export  HADOOP_HOME=/opt/module/hadoop-3.1.4</span><br><span class="line">export  PATH=$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$PATH</span><br></pre></td></tr></table></figure>

<blockquote>
<p>重新加载配置  </p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>



<h3 id="配置文件（Hadoop-3-1-2-etc-hadoop-目录下）"><a href="#配置文件（Hadoop-3-1-2-etc-hadoop-目录下）" class="headerlink" title="配置文件（Hadoop-3.1.2&#x2F;etc&#x2F;hadoop&#x2F;目录下）"></a>配置文件（Hadoop-3.1.2&#x2F;etc&#x2F;hadoop&#x2F;目录下）</h3><blockquote>
<p>将以下内容追加进去</p>
</blockquote>
<h4 id="hadoop-env-sh-文件"><a href="#hadoop-env-sh-文件" class="headerlink" title="hadoop-env.sh 文件"></a><code>hadoop-env.sh</code> 文件</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export JAVA_HOME=/opt/module/jdk1.8.0_241</span><br></pre></td></tr></table></figure>



<h4 id="core-site-xml-文件"><a href="#core-site-xml-文件" class="headerlink" title="core-site.xml 文件"></a><code>core-site.xml</code> 文件</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;hdfs://localhost:9820&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">        &lt;property&gt;</span><br><span class="line">        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;/home/hadoop/tmp&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>



<h4 id="hdfs-site-xml文件"><a href="#hdfs-site-xml文件" class="headerlink" title="hdfs-site.xml文件"></a><code>hdfs-site.xml</code>文件</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;1&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">               &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;</span><br><span class="line">             &lt;value&gt;/home/hadoop/tmp/dfs/name&lt;/value&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">          &lt;property&gt;</span><br><span class="line">               &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;</span><br><span class="line">             &lt;value&gt;/home/hadoop/tmp/dfs/data&lt;/value&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">          &lt;property&gt;</span><br><span class="line">               &lt;name&gt;dfs.namenode.http-address&lt;/name&gt;</span><br><span class="line">             &lt;value&gt;localhost:9870&lt;/value&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>



<h4 id="mapred-site-xml文件"><a href="#mapred-site-xml文件" class="headerlink" title="mapred-site.xml文件"></a><code>mapred-site.xml</code>文件</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;yarn&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;mapreduce.application.classpath&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*:$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>



<h4 id="yarn-site-xml文件"><a href="#yarn-site-xml文件" class="headerlink" title="yarn-site.xml文件"></a><code>yarn-site.xml</code>文件</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property </span><br><span class="line">        &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;yarn.nodemanager.env-whitelist&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_HOME,PATH,LANG,TZ,HADOOP_MAPRED_HOME&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.nodemanager.pmem-check-enabled&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;false&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.nodemanager.vmem-check-enabled&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;false&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p> <strong>将<code>workers</code>文件里的内容修改为主机名</strong></p>
</blockquote>
<h3 id="配置免密码登入"><a href="#配置免密码登入" class="headerlink" title="配置免密码登入"></a>配置免密码登入</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">生成SSH密钥对</span></span><br><span class="line">ssh-keygen -t rsa -P &#x27;&#x27; -f ~/.ssh/id_rsa</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将公钥添加到授权密钥文件中</span></span><br><span class="line">cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置适当的权限</span></span><br><span class="line">chmod 0600 ~/.ssh/authorized_keys</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">测试免密登录</span></span><br><span class="line">ssh localhost</span><br></pre></td></tr></table></figure>



<h3 id="格式化文件系统"><a href="#格式化文件系统" class="headerlink" title="格式化文件系统"></a>格式化文件系统</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hdfs namenode -format</span><br></pre></td></tr></table></figure>



<h3 id="在-hadoop-env-sh-文件里追加以下内容（2-x版本无需修改）"><a href="#在-hadoop-env-sh-文件里追加以下内容（2-x版本无需修改）" class="headerlink" title="在 hadoop-env.sh 文件里追加以下内容（2.x版本无需修改）"></a>在 <code>hadoop-env.sh</code> 文件里追加以下内容（2.x版本无需修改）</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export HDFS_NAMENODE_USER=root</span><br><span class="line">export HDFS_DATANODE_USER=root</span><br><span class="line">export HDFS_SECONDARYNAMENODE_USER=root</span><br><span class="line">export YARN_RESOURCEMANAGER_USER=root</span><br><span class="line">export YARN_NODEMANAGER_USER=root</span><br></pre></td></tr></table></figure>





<h3 id="启动Hadoop服务"><a href="#启动Hadoop服务" class="headerlink" title="启动Hadoop服务"></a>启动Hadoop服务</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">start-dfs.sh</span><br><span class="line">start-yarn.sh</span><br></pre></td></tr></table></figure>

<h4 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">systemctl stop firewalld.service</span><br></pre></td></tr></table></figure>



<h4 id="查看web-UI-页面"><a href="#查看web-UI-页面" class="headerlink" title="查看web UI 页面"></a>查看web UI 页面</h4><p><img src="/../../images/image-20240714224404021.png" alt="image-20240714224404021"></p>
<p><img src="/../../images/image-20240714224424762.png" alt="image-20240714224424762"></p>
<h2 id="zookeeper-安装"><a href="#zookeeper-安装" class="headerlink" title="zookeeper 安装"></a><code>zookeeper</code> 安装</h2><h3 id="解压软件包"><a href="#解压软件包" class="headerlink" title="解压软件包"></a>解压软件包</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zxvf apache-zookeeper-3.6.3-bin.tar.gz</span><br></pre></td></tr></table></figure>

<h3 id="进入zookeeper-conf-目录下"><a href="#进入zookeeper-conf-目录下" class="headerlink" title="进入zookeeper/conf 目录下"></a>进入<code>zookeeper/conf</code> 目录下</h3><blockquote>
<p><font color=red>由于配置的是伪分布式，故无需做出修改。</font></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">使用模板</span></span><br><span class="line">mv zoo_sample.cfg zoo.cfg</span><br></pre></td></tr></table></figure>

<h3 id="使用以下命令启动zookeeper"><a href="#使用以下命令启动zookeeper" class="headerlink" title="使用以下命令启动zookeeper"></a>使用以下命令启动<code>zookeeper</code></h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./zkServer.sh start</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/image-20240715140115127.png" alt="image-20240715140115127"></p>
<h2 id="Hbase安装-伪分布式"><a href="#Hbase安装-伪分布式" class="headerlink" title="Hbase安装(伪分布式)"></a><code>Hbase</code>安装(伪分布式)</h2><h3 id="解压软件包-1"><a href="#解压软件包-1" class="headerlink" title="解压软件包"></a>解压软件包</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zxvf hbase-2.4.13-bin.tar.gz</span><br></pre></td></tr></table></figure>

<h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim  /etc/profile.d/my_ver.sh</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">hbase var</span></span><br><span class="line">export  HBASE_HOME=/opt/module/hbase-2.4.13</span><br><span class="line">export  PATH=$HBASE_HOME/bin:$PATH</span><br></pre></td></tr></table></figure>

<h4 id="查看版本"><a href="#查看版本" class="headerlink" title="查看版本"></a>查看版本</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hbase version</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/image-20240715151406469.png" alt="image-20240715151406469"></p>
<h3 id="编辑-hbase-site-xml文件"><a href="#编辑-hbase-site-xml文件" class="headerlink" title="编辑 hbase-site.xml文件"></a>编辑 <code>hbase-site.xml</code>文件</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim  /hbase/conf/hbase-site.xml</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">追加以下内容：</span></span><br><span class="line"></span><br><span class="line">&lt;onfiguration&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.cluster.distributed&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;true&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.tmp.dir&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;/home/hbase/tmp&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.unsafe.stream.capability.enforce&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;false&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- hbase存放数据目录 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.rootdir&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;hdfs://192.168.38.21:9820/home/hbase&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"> &lt;!-- ZooKeeper数据文件路径 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.zookeeper.property.dataDir&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;/home/hbase/zookeeper&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"> &lt;!-- HMaster的web界面Ip地址 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.master.info.bindAddress&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;0.0.0.0&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"> &lt;!-- HMaster的web界面端口 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.master.info.port&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;16060&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">&lt;!-- zookeeper集群ip地址 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;192.168.38.21&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"> &lt;!--zookeeper集群的端口 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.zookeeper.property.clientPort&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;2181&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">&lt;!--hbase集群元数据在zookeeper中的路径 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;zookeeper.znode.parent&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;/hbase&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="编辑-hbase-env-sh-文件"><a href="#编辑-hbase-env-sh-文件" class="headerlink" title="编辑 hbase-env.sh 文件"></a>编辑 <code>hbase-env.sh</code> 文件</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim /hbase/conf/hbase-env.sh</span><br><span class="line"></span><br><span class="line">export JAVA_HOME=/opt/module/jdk1.8.0_241</span><br><span class="line">export HABSE_MANAGES_ZK=false</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="启动Hbase"><a href="#启动Hbase" class="headerlink" title="启动Hbase"></a>启动<code>Hbase</code></h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /opt/module/hbase-2.4.13/./bin/</span><br><span class="line"></span><br><span class="line">./start-hbase.sh </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看进程</span></span><br><span class="line">jps  -l </span><br></pre></td></tr></table></figure>

<p><img src="/../../images/image-20240715161447842.png" alt="image-20240715161447842"></p>
<h3 id="Web-UI-页面"><a href="#Web-UI-页面" class="headerlink" title="Web UI 页面"></a>Web UI 页面</h3><p><img src="/../../images/image-20240715161713169.png" alt="image-20240715161713169"></p>
<h2 id="Spark-安装（伪分布式）"><a href="#Spark-安装（伪分布式）" class="headerlink" title="Spark 安装（伪分布式）"></a><code>Spark</code> 安装（伪分布式）</h2><h3 id="解压软件包-2"><a href="#解压软件包-2" class="headerlink" title="解压软件包"></a>解压软件包</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zxvf spark-3.1.3-bin-hadoop3.2.tgz</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>IEC</category>
      </categories>
  </entry>
  <entry>
    <title>Mongodb_编程.md</title>
    <url>/2024/07/07/@code/Mongodb-%E7%BC%96%E7%A8%8B/</url>
    <content><![CDATA[<h1 id="Mongodb编程操作"><a href="#Mongodb编程操作" class="headerlink" title="Mongodb编程操作"></a>Mongodb编程操作</h1><span id="more"></span>

<h2 id="连接数据库及操作："><a href="#连接数据库及操作：" class="headerlink" title="连接数据库及操作："></a>连接数据库及操作：</h2><h3 id="主方法"><a href="#主方法" class="headerlink" title="主方法"></a>主方法</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hniu.bigdata.mongodb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mongodb.ConnectionString;</span><br><span class="line"><span class="keyword">import</span> com.mongodb.MongoClientSettings;</span><br><span class="line"><span class="keyword">import</span> com.mongodb.client.*;</span><br><span class="line"><span class="keyword">import</span> com.mongodb.client.model.CreateCollectionOptions;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Mongodb_main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">//        获取连接对象</span></span><br><span class="line">        <span class="type">Mongodb_main</span> <span class="variable">mongodb_main</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Mongodb_main</span>();</span><br><span class="line">        <span class="type">MongoClient</span> <span class="variable">client</span> <span class="operator">=</span> mongodb_main.initClient();</span><br><span class="line"></span><br><span class="line">        <span class="type">DataOperator</span> <span class="variable">dataOperator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataOperator</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//创建 namespace</span></span><br><span class="line">        <span class="type">MongoDatabase</span> <span class="variable">database</span> <span class="operator">=</span> client.getDatabase(<span class="string">&quot;bigdata2201&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//创建合集</span></span><br><span class="line">        <span class="type">MongoCollection</span> <span class="variable">collection</span> <span class="operator">=</span> database.getCollection(<span class="string">&quot;jyp15&quot;</span>);</span><br><span class="line">        </span><br><span class="line"><span class="comment">//        dataOperator.dataPut(collection);</span></span><br><span class="line"><span class="comment">//        dataOperator.getData(collection);</span></span><br><span class="line"><span class="comment">//        dataOperator.putManyData(collection);</span></span><br><span class="line"><span class="comment">//        dataOperator.insertByCommand(database);</span></span><br><span class="line"><span class="comment">//        dataOperator.deleteData(collection);</span></span><br><span class="line">        dataOperator.upDateByCommand(database);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//关闭数据库连接</span></span><br><span class="line">        client.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dataBaseOperator</span><span class="params">(MongoClient client)</span> &#123;</span><br><span class="line">        <span class="comment">//        创建数据库</span></span><br><span class="line">        <span class="type">MongoDatabase</span> <span class="variable">database</span> <span class="operator">=</span> client.getDatabase(<span class="string">&quot;bigdata2201&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//        创建集合/（表）</span></span><br><span class="line">        database.createCollection(<span class="string">&quot;jyp15&quot;</span>, <span class="keyword">new</span> <span class="title class_">CreateCollectionOptions</span>()</span><br><span class="line">                .capped(<span class="literal">true</span>)</span><br><span class="line">                .maxDocuments(<span class="number">10000</span>)</span><br><span class="line">                .sizeInBytes(<span class="number">1024</span> * <span class="number">1024</span> * <span class="number">512</span>));</span><br><span class="line">        <span class="comment">//        列出集合</span></span><br><span class="line">        MongoIterable&lt;String&gt; names = database.listCollectionNames();</span><br><span class="line">        <span class="keyword">for</span> (String name : names) &#123;</span><br><span class="line">            System.out.println(name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    连接Mongodb（数据库）</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> MongoClient <span class="title function_">initClient</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ConnectionString</span> <span class="variable">connectionString</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionString</span>(<span class="string">&quot;mongodb://192.168.15.15:27017&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">MongoClientSettings</span> <span class="variable">settings</span> <span class="operator">=</span> MongoClientSettings.builder()</span><br><span class="line">                .applyConnectionString(connectionString)</span><br><span class="line">                .applicationName(<span class="string">&quot;JiangYuPing&quot;</span>)</span><br><span class="line">                .applyToConnectionPoolSettings(builder -&gt; &#123;</span><br><span class="line">                    builder.maxSize(<span class="number">10</span>).minSize(<span class="number">5</span>).maxWaitTime(<span class="number">1000</span>, TimeUnit.MILLISECONDS);</span><br><span class="line">                &#125;)</span><br><span class="line">                .build();</span><br><span class="line">        <span class="type">MongoClient</span> <span class="variable">client</span> <span class="operator">=</span> MongoClients.create(settings);</span><br><span class="line">        <span class="keyword">return</span> client;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="数据操作方法类："><a href="#数据操作方法类：" class="headerlink" title="数据操作方法类："></a>数据操作方法类：</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hniu.bigdata.mongodb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.hniu.bigdata.hbase.CreateData;</span><br><span class="line"><span class="keyword">import</span> com.mongodb.client.MongoCollection;</span><br><span class="line"><span class="keyword">import</span> com.mongodb.client.MongoDatabase;</span><br><span class="line"><span class="keyword">import</span> com.mongodb.client.MongoIterable;</span><br><span class="line"><span class="keyword">import</span> org.bson.Document;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataOperator</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//    数据插入</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dataPut</span><span class="params">(MongoCollection collection)</span> &#123;</span><br><span class="line">        <span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Document</span>(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;JiangYuPing&quot;</span>);</span><br><span class="line">        doc.append(<span class="string">&quot;sex&quot;</span>, <span class="string">&quot;male&quot;</span>)</span><br><span class="line">                .append(<span class="string">&quot;age&quot;</span>, <span class="number">20</span>)</span><br><span class="line">                .append(<span class="string">&quot;major&quot;</span>, <span class="string">&quot;bigdata&quot;</span>);</span><br><span class="line">        collection.insertOne(doc);</span><br><span class="line">        System.out.println(<span class="string">&quot;数据插入成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    数据查询</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getData</span><span class="params">(MongoCollection collection)</span> &#123;</span><br><span class="line">        MongoIterable&lt;Document&gt; document = collection.find().limit(<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">for</span> (Document doc : document) &#123;</span><br><span class="line">            System.out.println(doc.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    批量插入</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">putManyData</span><span class="params">(MongoCollection collection)</span> &#123;</span><br><span class="line">        List&lt;Document&gt; documentList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">CreateData</span> <span class="variable">createData</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CreateData</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>; index &lt; <span class="number">10000</span>; index++) &#123;</span><br><span class="line">            <span class="type">JSONObject</span> <span class="variable">data</span> <span class="operator">=</span> createData.createData(<span class="number">240625</span>, <span class="number">11</span>);</span><br><span class="line">            <span class="type">Document</span> <span class="variable">document</span> <span class="operator">=</span> Document.parse(data.toString());</span><br><span class="line">            documentList.add(document);</span><br><span class="line">        &#125;</span><br><span class="line">        collection.insertMany(documentList);</span><br><span class="line">        System.out.println(<span class="string">&quot;批量数据插入成功！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    command 插入</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertByCommand</span><span class="params">(MongoDatabase database)</span> &#123;</span><br><span class="line">        <span class="comment">//spark集合，不存在则创建</span></span><br><span class="line">        <span class="type">Document</span> <span class="variable">insertDB</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Document</span>(<span class="string">&quot;insert&quot;</span>, <span class="string">&quot;spark&quot;</span>);</span><br><span class="line">        insertDB.append(<span class="string">&quot;documents&quot;</span>, Arrays.asList(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Document</span>(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;denny&quot;</span>).append(<span class="string">&quot;sex&quot;</span>, <span class="string">&quot;male&quot;</span>).append(<span class="string">&quot;major&quot;</span>, <span class="string">&quot;computer&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Document</span>(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;jimmy&quot;</span>).append(<span class="string">&quot;sex&quot;</span>, <span class="string">&quot;male&quot;</span>).append(<span class="string">&quot;major&quot;</span>, <span class="string">&quot;computer&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Document</span>(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;ALice&quot;</span>).append(<span class="string">&quot;sex&quot;</span>, <span class="string">&quot;female&quot;</span>).append(<span class="string">&quot;major&quot;</span>, <span class="string">&quot;computer&quot;</span>)</span><br><span class="line">        ));</span><br><span class="line">        insertDB.append(<span class="string">&quot;ordered&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">        database.runCommand(insertDB);</span><br><span class="line">        System.out.println(<span class="string">&quot;command 插入成功！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    删除数据</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteData</span><span class="params">(MongoCollection collection)</span> &#123;</span><br><span class="line">        <span class="type">Document</span> <span class="variable">document</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Document</span>();</span><br><span class="line">        document.append(<span class="string">&quot;car_color&quot;</span>, <span class="string">&quot;red&quot;</span>);</span><br><span class="line"></span><br><span class="line">        collection.deleteMany(document);</span><br><span class="line">        System.out.println(<span class="string">&quot;数据删除成功！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//    更新数据</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">upDateByCommand</span><span class="params">(MongoDatabase database)</span> &#123;</span><br><span class="line">        <span class="type">Document</span> <span class="variable">updateDoc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Document</span>(<span class="string">&quot;update&quot;</span>, <span class="string">&quot;jyp15&quot;</span>);</span><br><span class="line">        updateDoc.append(<span class="string">&quot;updates&quot;</span>, Arrays.asList(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Document</span>(<span class="string">&quot;q&quot;</span>, <span class="keyword">new</span> <span class="title class_">Document</span>(<span class="string">&quot;car_color&quot;</span>, <span class="string">&quot;black&quot;</span>))</span><br><span class="line">                        .append(<span class="string">&quot;u&quot;</span>, <span class="keyword">new</span> <span class="title class_">Document</span>(<span class="string">&quot;$set&quot;</span>, <span class="keyword">new</span> <span class="title class_">Document</span>(<span class="string">&quot;video_name&quot;</span>, <span class="string">&quot;JiangYuPing&quot;</span>)))</span><br><span class="line">                        .append(<span class="string">&quot;multi&quot;</span>, <span class="literal">true</span>)</span><br><span class="line">                        .append(<span class="string">&quot;upsert&quot;</span>, <span class="literal">true</span>)</span><br><span class="line">        )).append(<span class="string">&quot;ordered&quot;</span>, <span class="literal">true</span>).append(<span class="string">&quot;maxTimeMS&quot;</span>, <span class="number">10000</span>);</span><br><span class="line">        <span class="type">Document</span> <span class="variable">result</span> <span class="operator">=</span> database.runCommand(updateDoc);</span><br><span class="line">        System.out.println(result.toString());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Code</category>
      </categories>
  </entry>
  <entry>
    <title>hadoop on yran 模式</title>
    <url>/2024/07/01/IEC/hadoop%20on%20yran%20%E6%A8%A1%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="hadoop-on-yran-模式"><a href="#hadoop-on-yran-模式" class="headerlink" title="hadoop on yran 模式"></a><strong>hadoop on yran 模式</strong></h1><h2 id="Spark安装部署：On-Yarn模式"><a href="#Spark安装部署：On-Yarn模式" class="headerlink" title="Spark安装部署：On Yarn模式"></a>Spark安装部署：On Yarn模式</h2><span id="more"></span>

<h2 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a><strong>实验步骤</strong></h2><h3 id="打开命令行终端，切换到spark压缩包所在目录"><a href="#打开命令行终端，切换到spark压缩包所在目录" class="headerlink" title="打开命令行终端，切换到spark压缩包所在目录"></a>打开命令行终端，切换到spark压缩包所在目录</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /home/zkpk/tgz/spark/</span><br></pre></td></tr></table></figure>

<h3 id="解压压缩包到用户根目录"><a href="#解压压缩包到用户根目录" class="headerlink" title="解压压缩包到用户根目录"></a>解压压缩包到用户根目录</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zxvf spark-2.1.1-bin-hadoop2.7.tgz -C /home/zkpk/</span><br></pre></td></tr></table></figure>

<h3 id="进入解压出的spark目录，运行ll即可看到此目录下的内容"><a href="#进入解压出的spark目录，运行ll即可看到此目录下的内容" class="headerlink" title="进入解压出的spark目录，运行ll即可看到此目录下的内容"></a>进入解压出的spark目录，运行ll即可看到此目录下的内容</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd spark-2.1.1-bin-hadoop2.7/</span><br></pre></td></tr></table></figure>

<h4 id="返回到根目录，编辑-bash-profile文件，添加如下三个环境变量，保存退出。"><a href="#返回到根目录，编辑-bash-profile文件，添加如下三个环境变量，保存退出。" class="headerlink" title="返回到根目录，编辑 .bash_profile文件，添加如下三个环境变量，保存退出。"></a>返回到根目录，编辑 .bash_profile文件，添加如下三个环境变量，保存退出。</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim .bash_profile</span><br><span class="line"></span><br><span class="line">export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop</span><br><span class="line">export HDFS_CONF_DIR=$HADOOP_HOME/etc/hadoop</span><br><span class="line">export YARN_CONF_DIR=$HADOOP_HOME/etc/hadoop</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../../images/image-20240701144752494.png" alt="image-20240701144752494"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">source  .bash_profile #重新加载配置文件，使添加的变量生效</span><br></pre></td></tr></table></figure>

<h4 id="有时候我们在启动Spark-on-Yarn时会出现内存大小错误，此时job会被强制杀死，为了避免这一情况，我们编辑-home-zkpk-hadoop-2-7-3-etc-hadoop目录下的yarn-site-xml文件"><a href="#有时候我们在启动Spark-on-Yarn时会出现内存大小错误，此时job会被强制杀死，为了避免这一情况，我们编辑-home-zkpk-hadoop-2-7-3-etc-hadoop目录下的yarn-site-xml文件" class="headerlink" title="有时候我们在启动Spark on Yarn时会出现内存大小错误，此时job会被强制杀死，为了避免这一情况，我们编辑&#x2F;home&#x2F;zkpk&#x2F;hadoop-2.7.3&#x2F;etc&#x2F;hadoop目录下的yarn-site.xml文件"></a>有时候我们在启动Spark on Yarn时会出现内存大小错误，此时job会被强制杀死，为了避免这一情况，我们编辑&#x2F;home&#x2F;zkpk&#x2F;hadoop-2.7.3&#x2F;etc&#x2F;hadoop目录下的yarn-site.xml文件</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">d hadoop-2.7.3/etc/hadoop/</span><br><span class="line"></span><br><span class="line">vim yarn.site.xml #添加以下内容</span><br><span class="line"></span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.nodemanager.pmem-check-enabled&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;false&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.nodemanager.vmem-check-enabled&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;false&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../../images/image-20240701151827996.png" alt="image-20240701151827996"></p>
<h4 id="将yarn-site-xml文件发送到从节点"><a href="#将yarn-site-xml文件发送到从节点" class="headerlink" title="将yarn-site.xml文件发送到从节点"></a>将yarn-site.xml文件发送到从节点</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">scp yarn-site.xml zkpk@slave01:/home/zkpk/hadoop-2.7.3/etc/hadoop</span><br><span class="line"></span><br><span class="line"> scp yarn-site.xml zkpk@slave02:/home/zkpk/hadoop-2.7.3/etc/hadoop</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/image-20240701152019498.png" alt="image-20240701152019498"></p>
<h3 id="启动Hadoop集群"><a href="#启动Hadoop集群" class="headerlink" title="启动Hadoop集群"></a>启动Hadoop集群</h3><h4 id="在master启动Hadoop集群"><a href="#在master启动Hadoop集群" class="headerlink" title="在master启动Hadoop集群"></a>在master启动Hadoop集群</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">格式化</span></span><br><span class="line">hadoop namenode -format</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动集群</span></span><br><span class="line">start-all.sh</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">关闭安全模式</span></span><br><span class="line">hdfs dfsadmin -safemode  leave</span><br></pre></td></tr></table></figure>

<h3 id="验证Spark-on-Yarn安装部署是否生效"><a href="#验证Spark-on-Yarn安装部署是否生效" class="headerlink" title="验证Spark on Yarn安装部署是否生效"></a>验证Spark on Yarn安装部署是否生效</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd spark-2.1.1-bin-hadoop2.7/</span><br><span class="line"></span><br><span class="line">./bin/spark-submit --class org.apache.spark.examples.SparkPi --master yarn --num-executors 3 --driver-memory 1g --executor-memory 1g --executor-cores 1 examples/jars/spark-examples_2.11-2.1.1.jar 10</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/image-20240701152546256.png" alt="image-20240701152546256"></p>
<h3 id="访问WebUI"><a href="#访问WebUI" class="headerlink" title="访问WebUI"></a>访问WebUI</h3><p><img src="/../../images/image-20240701152608181.png" alt="image-20240701152608181"></p>
]]></content>
      <categories>
        <category>IEC</category>
      </categories>
  </entry>
  <entry>
    <title>spark_streaming编程.md</title>
    <url>/2024/07/08/@code/spark-streaming%E7%BC%96%E7%A8%8B-md/</url>
    <content><![CDATA[<h1 id="spark-编程"><a href="#spark-编程" class="headerlink" title="spark_编程"></a>spark_编程</h1><span id="more"></span>

<h2 id="hdfs-streaming"><a href="#hdfs-streaming" class="headerlink" title="hdfs_streaming"></a>hdfs_streaming</h2><figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> scala.org.<span class="type">Learn</span>.<span class="type">SparkStream</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.<span class="type">SparkConf</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.streaming.&#123;<span class="type">Seconds</span>, <span class="type">StreamingContext</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">hdfs_streaming</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;hdfs_streaming&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> ssc = <span class="keyword">new</span> <span class="type">StreamingContext</span>(conf, <span class="type">Seconds</span>(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> filePath = args(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> fileStream = ssc.textFileStream(filePath)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> words = fileStream.flatMap(_.split(<span class="string">&quot; &quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> wordPairs = words.map((_, <span class="number">1</span>)).reduceByKey(_ + _)</span><br><span class="line"></span><br><span class="line">    wordPairs.print()</span><br><span class="line">    ssc.start()</span><br><span class="line">    ssc.awaitTermination()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="TCP-streaming"><a href="#TCP-streaming" class="headerlink" title="TCP_streaming"></a>TCP_streaming</h2><figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> scala.org.<span class="type">Learn</span>.<span class="type">SparkStream</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.<span class="type">SparkConf</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.streaming.&#123;<span class="type">Seconds</span>, <span class="type">StreamingContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Tcp__streaming</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Tcp_streaming&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> ssc = <span class="keyword">new</span> <span class="type">StreamingContext</span>(conf, <span class="type">Seconds</span>(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> textStram = ssc.socketTextStream(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">9999</span>)</span><br><span class="line">    <span class="keyword">val</span> words = textStram.flatMap(_.split(<span class="string">&quot; &quot;</span>))</span><br><span class="line">    <span class="keyword">val</span> wordPair = words.map((_,<span class="number">1</span>)).reduceByKey(_ + _)</span><br><span class="line">    wordPair.print()</span><br><span class="line">    ssc.start()</span><br><span class="line">    ssc.awaitTermination()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Code</category>
      </categories>
  </entry>
</search>
